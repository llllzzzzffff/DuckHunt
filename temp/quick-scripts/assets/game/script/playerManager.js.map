{"version":3,"sources":["playerManager.js"],"names":["mvs","require","GLB","cc","Class","extends","Component","properties","playerNodes","Node","scoreLbs","onLoad","Game","PlayerManager","players","clientEvent","on","eventType","gameStart","initPlayers","uiGamePanel","uiFunc","findUI","i","length","player","playerUserIds","playerScript","getComponent","init","push","active","getPlayerByUserId","userId","onDestroy","off"],"mappings":";;;;;;AAAA,IAAIA,MAAMC,QAAQ,SAAR,CAAV;AACA,IAAIC,MAAMD,QAAQ,KAAR,CAAV;AACAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,qBAAa,CAACL,GAAGM,IAAJ,CADL;AAERC,kBAAU,CAACP,GAAGM,IAAJ;AAFF,KAHP;;AAQLE,UARK,oBAQI;AACLC,aAAKC,aAAL,GAAqB,IAArB;AACA,aAAKC,OAAL,GAAe,EAAf;AACAC,oBAAYC,EAAZ,CAAeD,YAAYE,SAAZ,CAAsBC,SAArC,EAAgD,KAAKC,WAArD,EAAkE,IAAlE;AACH,KAZI;;;AAcL;AACAA,iBAAa,uBAAW;AACpB,YAAIC,cAAcC,OAAOC,MAAP,CAAc,aAAd,CAAlB;AACA,YAAI,CAACF,WAAL,EAAkB;AACd;AACH;;AAED,aAAK,IAAIG,IAAI,CAAb,EAAgBA,IAAI,KAAKf,WAAL,CAAiBgB,MAArC,EAA6CD,GAA7C,EAAkD;AAC9C,gBAAIE,SAAS,KAAKjB,WAAL,CAAiBe,CAAjB,CAAb;AACA,gBAAGrB,IAAIwB,aAAJ,CAAkBF,MAAlB,GAA2BD,CAA9B,EAAiC;AAC7B,oBAAII,eAAeF,OAAOG,YAAP,CAAoB,QAApB,CAAnB;AACA,oBAAID,YAAJ,EAAkB;AACdA,iCAAaE,IAAb,CAAkB3B,IAAIwB,aAAJ,CAAkBH,CAAlB,CAAlB;AACH;AACD,qBAAKT,OAAL,CAAagB,IAAb,CAAkBL,MAAlB;AACA,qBAAKf,QAAL,CAAca,CAAd,EAAiBQ,MAAjB,GAA0B,IAA1B;AACH,aAPD,MAOK;AACDN,uBAAOM,MAAP,GAAgB,KAAhB;AACA,qBAAKrB,QAAL,CAAca,CAAd,EAAiBQ,MAAjB,GAA0B,KAA1B;AACH;AACJ;AACJ,KAnCI;;AAqCLC,uBAAmB,2BAASC,MAAT,EAAiB;AAChC,aAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAIrB,IAAIwB,aAAJ,CAAkBF,MAAtC,EAA8CD,GAA9C,EAAmD;AAC/C,gBAAIrB,IAAIwB,aAAJ,CAAkBH,CAAlB,MAAyBU,MAAzB,IAAmC,KAAKnB,OAAxC,IAAmD,KAAKA,OAAL,CAAaS,CAAb,CAAvD,EAAwE;AACpE,uBAAO,KAAKT,OAAL,CAAaS,CAAb,EAAgBK,YAAhB,CAA6B,QAA7B,CAAP;AACH;AACJ;AACD,eAAO,IAAP;AACH,KA5CI;;AA8CLM,eAAW,qBAAW;AAClBnB,oBAAYoB,GAAZ,CAAgBpB,YAAYE,SAAZ,CAAsBC,SAAtC,EAAiD,KAAKC,WAAtD,EAAmE,IAAnE;AACH;AAhDI,CAAT","file":"playerManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\game\\script","sourcesContent":["var mvs = require(\"Matchvs\");\r\nvar GLB = require(\"Glb\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        playerNodes: [cc.Node],\r\n        scoreLbs: [cc.Node],\r\n    },\r\n\r\n    onLoad() {\r\n        Game.PlayerManager = this;\r\n        this.players = [];\r\n        clientEvent.on(clientEvent.eventType.gameStart, this.initPlayers, this);\r\n    },\r\n\r\n    // 初始化玩家--\r\n    initPlayers: function() {\r\n        var uiGamePanel = uiFunc.findUI(\"uiGamePanel\");\r\n        if (!uiGamePanel) {\r\n            return;\r\n        }\r\n\r\n        for (var i = 0; i < this.playerNodes.length; i++) {\r\n            var player = this.playerNodes[i];\r\n            if(GLB.playerUserIds.length > i) {\r\n                var playerScript = player.getComponent(\"player\");\r\n                if (playerScript) {\r\n                    playerScript.init(GLB.playerUserIds[i]);\r\n                }\r\n                this.players.push(player);\r\n                this.scoreLbs[i].active = true;\r\n            }else{\r\n                player.active = false;\r\n                this.scoreLbs[i].active = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    getPlayerByUserId: function(userId) {\r\n        for (var i = 0; i < GLB.playerUserIds.length; i++) {\r\n            if (GLB.playerUserIds[i] === userId && this.players && this.players[i]) {\r\n                return this.players[i].getComponent(\"player\");\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n\r\n    onDestroy: function() {\r\n        clientEvent.off(clientEvent.eventType.gameStart, this.initPlayers, this);\r\n    }\r\n});\r\n"]}